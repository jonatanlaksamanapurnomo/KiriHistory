<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
          integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.standalone.min.css"
          integrity="sha512-TQQ3J4WkE/rwojNFo6OJdyu6G8Xe9z8rMrlF9y7xpFbQfW5g8aSWcygCQ4vqRiJqFsDsE1T6MoAOMJkFXlrI9A=="
          crossorigin="anonymous"/>

    <title>KIRI HISTORY</title>
    <style type="text/css">
        /* Always set the map height explicitly to define the size of the div
         * element that contains the map. */
        #map {
            height: 100%;
        }

        /* Optional: Makes the sample page fill the window. */
        html,
        body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body>
<!--Section: Contact v.2-->
<section class="section">

    <!--Section heading-->
    <h2 class="section-heading h1 pt-4 mb-5 text-center ">KIRI</h2>

    <div class="card">

<!--        <div class="card-body">-->
<!--            <div class="row">-->
<!--                <div class="col-12">-->
<!--                    <div class="row">-->
<!--                        <div class="col-6">-->
<!--                            <p class="lead text-center ">Start Date</p>-->
<!--                            <input class="datepicker w-100 " id="startDate" data-date-format="mm/dd/yyyy">-->

<!--                        </div>-->
<!--                        <div class="col-6">-->
<!--                            <p class="lead text-center ">End Date</p>-->
<!--                            <input class="datepicker w-100" id="endDate" data-date-format="mm/dd/yyyy">-->
<!--                        </div>-->

<!--                        <div class="col-6">-->
<!--                            <p class="lead text-center ">Start Hour</p>-->
<!--                            <select id="startHour" class="form-control" id="exampleFormControlSelect1">-->
<!--                                <option value="1">01:00</option>-->
<!--                                <option value="2">02:00</option>-->
<!--                                <option value="3">03:00</option>-->
<!--                                <option value="4">04:00</option>-->
<!--                                <option value="5">05:00</option>-->
<!--                                <option value="6">06:00</option>-->
<!--                                <option value="7">07:00</option>-->
<!--                                <option value="8">08:00</option>-->
<!--                                <option value="9">09:00</option>-->
<!--                                <option value="10">10:00</option>-->
<!--                                <option value="11">11:00</option>-->
<!--                                <option value="12">12:00</option>-->
<!--                                <option value="13">13:00</option>-->
<!--                                <option value="14">14:00</option>-->
<!--                                <option value="15">15:00</option>-->
<!--                                <option value="16">16:00</option>-->
<!--                                <option value="17">17:00</option>-->
<!--                                <option value="18">18:00</option>-->
<!--                                <option value="19">19:00</option>-->
<!--                                <option value="20">20:00</option>-->
<!--                                <option value="21">21:00</option>-->
<!--                                <option value="22">22:00</option>-->
<!--                                <option value="23">23:00</option>-->
<!--                            </select>-->

<!--                        </div>-->
<!--                        <div class="col-6">-->
<!--                            <p class="lead text-center ">End Hour</p>-->
<!--                            <select id="endHour" class="form-control" id="exampleFormControlSelect1">-->
<!--                                <option value="1">01:00</option>-->
<!--                                <option value="2">02:00</option>-->
<!--                                <option value="3">03:00</option>-->
<!--                                <option value="4">04:00</option>-->
<!--                                <option value="5">05:00</option>-->
<!--                                <option value="6">06:00</option>-->
<!--                                <option value="7">07:00</option>-->
<!--                                <option value="8">08:00</option>-->
<!--                                <option value="9">09:00</option>-->
<!--                                <option value="10">10:00</option>-->
<!--                                <option value="11">11:00</option>-->
<!--                                <option value="12">12:00</option>-->
<!--                                <option value="13">13:00</option>-->
<!--                                <option value="14">14:00</option>-->
<!--                                <option value="15">15:00</option>-->
<!--                                <option value="16">16:00</option>-->
<!--                                <option value="17">17:00</option>-->
<!--                                <option value="18">18:00</option>-->
<!--                                <option value="19">19:00</option>-->
<!--                                <option value="20">20:00</option>-->
<!--                                <option value="21">21:00</option>-->
<!--                                <option value="22">22:00</option>-->
<!--                                <option value="23">23:00</option>-->
<!--                            </select>-->
<!--                        </div>-->
<!--                        <div class="col-6 mt-2">-->
<!--                            <p class="text-center lead">Start Day</p>-->
<!--                            <select id="startDay" class="form-control" id="exampleFormControlSelect1">-->
<!--                                <option value="1">Senin</option>-->
<!--                                <option value="2">Selasa</option>-->
<!--                                <option value="3">Rabu</option>-->
<!--                                <option value="4">Kami</option>-->
<!--                                <option value="5">Jumat</option>-->
<!--                                <option value="6">Sabtu</option>-->
<!--                                <option value="7">Minggu</option>-->
<!--                            </select>-->
<!--                        </div>-->
<!--                        <div class="col-6 mt-2">-->
<!--                            <p class="text-center lead"> End Day</p>-->
<!--                            <select id="endDay" class="form-control" id="exampleFormControlSelect1">-->
<!--                                <option value="1">Senin</option>-->
<!--                                <option value="2">Selasa</option>-->
<!--                                <option value="3">Rabu</option>-->
<!--                                <option value="4">Kami</option>-->
<!--                                <option value="5">Jumat</option>-->
<!--                                <option value="6">Sabtu</option>-->
<!--                                <option value="7">Minggu</option>-->
<!--                            </select>-->
<!--                        </div>-->
<!--                        <div class="col-6 mt-2">-->
<!--                            <div class="form-check d-flex justify-content-left">-->
<!--                                <input type="checkbox" class="form-check-input" id="isHeatMap">-->
<!--                                <label class="form-check-label" for="exampleCheck1">Heat Map</label>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="col-6 mt-2">-->
<!--                            <div class="form-check d-flex justify-content-left">-->
<!--                                <input type="checkbox" class="form-check-input" id="isMarkerClustering">-->
<!--                                <label class="form-check-label" for="exampleCheck1">Marker Clustering</label>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    <div class="col-12 mt-5">-->
<!--                        <div class="d-flex justify-content-center">-->
<!--                            <input type="button" name="delete-image" id="search-btn" class="btn btn-primary"-->
<!--                                   value="Search">-->
<!--                        </div>-->

<!--                    </div>-->
<!--                </div>-->

<!--            </div>-->

<!--        </div>-->
        <div class="d-flex justify-content-center">
            <input type="button" name="delete-image" id="search-btn" class="btn btn-primary"
                   value="Search">
        </div>

        <!--Google map-->
        <div id="map-container-google-12" class="z-depth-1-half map-container-7 mt-5" style="height: 100vh">
            <div id="map"></div>
        </div>


    </div>

    </div>

</section>
<!--Section: Contact v.2-->


<script
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCeLYwPPpDiL1RjRscCPShSCBJAWamzu-I&callback=initMap&libraries=visualization&v=weekly"
        defer></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"
        integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg=="
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"
        integrity="sha512-T/tUfKSV1bihCnd+MxKD0Hm1uBBroVYBOYSk1knyvQ9VyZJpc/ALb4P0r6ubwVPSGB2GvjeoMAJJImBG12TiaQ=="
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.0/axios.min.js"
        integrity="sha512-DZqqY3PiOvTP9HkjIWgjO6ouCbq+dxqWoJZ/Q+zPYNHmlnI2dQnbJ5bxAHpAMw+LXRm4D72EIRXzvcHQtE8/VQ=="
        crossorigin="anonymous"></script>
<script src="https://unpkg.com/@googlemaps/markerclustererplus/dist/index.min.js"></script>
<script>


    // const GMAPS_API_KEY = "AIzaSyCeLYwPPpDiL1RjRscCPShSCBJAWamzu-I";


    function initMap() {
        let map = new google.maps.Map(document.getElementById("map"), {
            center: {lat: -6.914744, lng: 107.609810},
            zoom: 12,
        });
        return map;
    }

    function showMarker(data){
        let locations = [];
        const labels = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
        data.forEach(item => {
            let startCoor = item.start
            let endCoor = item.end
            locations.push(startCoor)
            locations.push(endCoor)
        })
        let markers = locations.map((location, i) => {
            return new google.maps.Marker({
                position: { lat: location.lat, lng:location.lng },
                label: labels[i % labels.length],
            });
        });
        return markers;
    }

    function setHeatMap(arrData) {
        let heatmapData = [];
        arrData.forEach(item => {
            let startCoor = new google.maps.LatLng(item.start.lat, item.start.lng)
            let endCoor = new google.maps.LatLng(item.end.lat, item.end.lng)
            heatmapData.push(startCoor)
            heatmapData.push(endCoor)
        })
        let heatmap = new google.maps.visualization.HeatmapLayer({
            data: heatmapData
        });
        return heatmap;
    }

    function sendRequest(url, data = {}) {
        return axios.post(url, data);
    }



    $(function () {
        let map = initMap()
        let data = [];
        $(document).on('click', '#search-btn', function (e) {
            e.preventDefault();
            sendRequest("http://localhost:3000/searchRoute").then(res => {
                data = res.data.data;
                let markers = showMarker(data)
                new MarkerClusterer(map, markers, {
                    imagePath:
                        "https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m",
                });


            });
        })
    });
</script>
</body>
</html>